<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= appData.name %></title>
</head>
<body>
    <h1>Profile</h1>
    <form action="update" method="POST">

        <div class="form-group">
            <label>First Name:</label>
            <span class="view-mode"><%= user.fname %></span>
            <input class="edit-mode" type="text" name="fname" value="<%= user.fname %>" style="display:none;">
        </div>

        <div class="form-group">
            <label>Middle Name:</label>
            <span class="view-mode"><%= user.mname %></span>
            <input class="edit-mode" type="text" name="mname" value="<%= user.mname %>" style="display:none;">
        </div>

        <div class="form-group">
            <label>Last Name:</label>
            <span class="view-mode"><%= user.lname %></span>
            <input class="edit-mode" type="text" name="lname" value="<%= user.lname %>" style="display:none;">
        </div>

        <div class="form-group">
            <label>Email:</label>
            <span class="view-mode"><%= user.email %></span>
            <input class="edit-mode" type="email" name="email" value="<%= user.email %>" style="display:none;">
        </div>
        
        <div class="form-group">
            <label>Phone:</label>
            <span class="view-mode"><%= user.phone %></span>
            <input class="edit-mode" type="text" name="phone" value="<%= user.phone %>" style="display:none;">
        </div>

        <br>
        <button type="button" id="editBtn" onclick="toggleEditMode()">Edit Profile</button>
        
        <div id="saveBtns" style="display:none;">
            <button type="submit">Save Changes</button>
            <a href="profile">Cancel</a>
        </div>

    </form>

    <form action="change_password" method="POST">
    
        <div class="form-group">
            <label>Current Password:</label>
            <input type="password" name="current_password" required>
        </div>

        <div class="form-group">
            <label>New Password:</label>
            <input type="password" name="new_password" required>
        </div>

        <div class="form-group">
            <label>Confirm New Password:</label>
            <input type="password" name="confirm_password" required>
        </div>

        <button type="submit">Update Password</button>

    </form>

    <% if (typeof errors != 'undefined' && errors.length > 0) { %>
        <div class="error-box" style="background: #ffdddd; padding: 10px; border: 1px solid red; margin-bottom: 10px;">
            <h3>Please correct the following errors:</h3>
            <ul>
                <% errors.forEach(function(error) { %>
                    <li><%= error.msg %></li>
                <% }) %>
            </ul>
        </div>
    <% } %>

    <script>
        function toggleEditMode() {
            // 1. Find all elements with class 'view-mode' and hide them
            document.querySelectorAll('.view-mode').forEach(el => el.style.display = 'none');

            // 2. Find all elements with class 'edit-mode' and show them
            document.querySelectorAll('.edit-mode').forEach(el => el.style.display = 'block');

            // 3. Hide the Edit button, Show the Save buttons
            document.getElementById('editBtn').style.display = 'none';
            document.getElementById('saveBtns').style.display = 'block';
        }
    </script>
</body>
</html>